[debug] [2025-08-27T11:27:45.791Z] ----------------------------------------------------------------------
[debug] [2025-08-27T11:27:45.792Z] Command:       C:\nvm4w\nodejs\node.exe C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\bin\firebase.js deploy --only functions
[debug] [2025-08-27T11:27:45.792Z] CLI Version:   14.14.0
[debug] [2025-08-27T11:27:45.793Z] Platform:      win32
[debug] [2025-08-27T11:27:45.793Z] Node Version:  v22.18.0
[debug] [2025-08-27T11:27:45.793Z] Time:          Wed Aug 27 2025 13:27:45 GMT+0200 (Ora legale dellâ€™Europa centrale)
[debug] [2025-08-27T11:27:45.793Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-08-27T11:27:45.894Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-08-27T11:27:45.894Z] > authorizing via signed-in user (tommaso.scalici.1991@gmail.com)
[debug] [2025-08-27T11:27:45.894Z] [iam] checking project tax-code-flutter for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-08-27T11:27:45.895Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:45.895Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:45.895Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions [none]
[debug] [2025-08-27T11:27:45.895Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions x-goog-quota-user=projects/tax-code-flutter
[debug] [2025-08-27T11:27:45.895Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-08-27T11:27:46.696Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions 200
[debug] [2025-08-27T11:27:46.696Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-08-27T11:27:46.696Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:46.696Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:46.696Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-08-27T11:27:46.696Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-08-27T11:27:47.473Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-08-27T11:27:47.473Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'tax-code-flutter'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] Running command: npm --prefix "$RESOURCE_DIR" run build
[info] +  functions: Finished running predeploy script. 
[debug] [2025-08-27T11:27:52.272Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:52.272Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:52.272Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter [none]
[debug] [2025-08-27T11:27:53.097Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter 200
[debug] [2025-08-27T11:27:53.097Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter {"projectNumber":"1006489964692","projectId":"tax-code-flutter","lifecycleState":"ACTIVE","name":"Tax Code","labels":{"firebase":"enabled","generative-language":"enabled"},"createTime":"2024-07-01T12:17:58.718194Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-08-27T11:27:53.099Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.099Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.099Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/tax-code-flutter/adminSdkConfig [none]
[debug] [2025-08-27T11:27:53.423Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/tax-code-flutter/adminSdkConfig 200
[debug] [2025-08-27T11:27:53.423Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/tax-code-flutter/adminSdkConfig {"projectId":"tax-code-flutter","storageBucket":"tax-code-flutter.firebasestorage.app"}
[debug] [2025-08-27T11:27:53.424Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.424Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.424Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs [none]
[debug] [2025-08-27T11:27:53.694Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs 200
[debug] [2025-08-27T11:27:53.694Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs {"configs":[{"name":"projects/tax-code-flutter/configs/google"}]}
[debug] [2025-08-27T11:27:53.694Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.694Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.694Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables [none]
[debug] [2025-08-27T11:27:53.916Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables 200
[debug] [2025-08-27T11:27:53.916Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables {"variables":[{"name":"projects/tax-code-flutter/configs/google/variables/vision/key","updateTime":"2024-10-12T18:32:43.792485565Z"}]}
[debug] [2025-08-27T11:27:53.916Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.916Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:53.916Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables/vision/key [none]
[debug] [2025-08-27T11:27:54.114Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables/vision/key 200
[debug] [2025-08-27T11:27:54.114Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables/vision/key {"name":"projects/tax-code-flutter/configs/google/variables/vision/key","updateTime":"2024-10-12T18:32:43.792485565Z","text":"$(cat functions/tax-code-flutter-5fd627c30f2b.json)"}
[debug] [2025-08-27T11:27:54.115Z] Validating nodejs source
[debug] [2025-08-27T11:27:54.576Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "22"
  },
  "main": "lib/index.js",
  "dependencies": {
    "@google-cloud/vertexai": "^1.10.0",
    "firebase-admin": "^12.6.0",
    "firebase-functions": "^6.0.1"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-config-prettier": "^10.1.8",
    "eslint-plugin-import": "^2.25.4",
    "eslint-plugin-prettier": "^5.5.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^5.7.3"
  },
  "private": true
}
[debug] [2025-08-27T11:27:54.576Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-08-27T11:27:54.577Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-08-27T11:27:54.583Z] Found firebase-functions binary at 'C:\Users\Tommaso\source\repos\tax_code_flutter\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8915

[debug] [2025-08-27T11:27:54.898Z] Got response from /__/functions.yaml {"endpoints":{"extractDataFromDocument":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","vpc":null,"platform":"gcfv2","region":["europe-west1"],"labels":{},"callableTrigger":{},"entryPoint":"extractDataFromDocument"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2025-08-27T11:27:58.927Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-08-27T11:27:58.927Z] > authorizing via signed-in user (tommaso.scalici.1991@gmail.com)
[debug] [2025-08-27T11:27:58.927Z] [iam] checking project tax-code-flutter for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2025-08-27T11:27:58.927Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:58.927Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:58.928Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions [none]
[debug] [2025-08-27T11:27:58.928Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions x-goog-quota-user=projects/tax-code-flutter
[debug] [2025-08-27T11:27:58.928Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-08-27T11:27:59.730Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions 200
[debug] [2025-08-27T11:27:59.730Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-08-27T11:27:59.731Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:59.731Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:27:59.731Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/tax-code-flutter/instances pageSize=100&pageToken=
[debug] [2025-08-27T11:28:00.616Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/tax-code-flutter/instances 200
[debug] [2025-08-27T11:28:00.616Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/tax-code-flutter/instances {}
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged C:\Users\Tommaso\source\repos\tax_code_flutter\functions (95.9 KB) for uploading 
[debug] [2025-08-27T11:28:00.641Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:00.641Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:00.641Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/tax-code-flutter/locations/-/functions [none]
[debug] [2025-08-27T11:28:01.286Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/tax-code-flutter/locations/-/functions 200
[debug] [2025-08-27T11:28:01.286Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/tax-code-flutter/locations/-/functions {}
[debug] [2025-08-27T11:28:01.286Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:01.286Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:01.287Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-08-27T11:28:02.348Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/-/functions 200
[debug] [2025-08-27T11:28:02.349Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/-/functions {}
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[debug] [2025-08-27T11:28:02.351Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:02.351Z] Checked if tokens are valid: true, expires at: 1756297382494
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-08-27T11:28:02.351Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:02.351Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:02.351Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-08-27T11:28:02.351Z] >>> [apiv2][(partial)header] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity x-goog-quota-user=projects/1006489964692
[debug] [2025-08-27T11:28:02.351Z] >>> [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity {}
[debug] [2025-08-27T11:28:02.352Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-08-27T11:28:02.352Z] >>> [apiv2][(partial)header] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity x-goog-quota-user=projects/1006489964692
[debug] [2025-08-27T11:28:02.352Z] >>> [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity {}
[debug] [2025-08-27T11:28:03.346Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-08-27T11:28:03.346Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1006489964692@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"104764459741738401703"}}
[debug] [2025-08-27T11:28:03.356Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-08-27T11:28:03.356Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1006489964692@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"111937492104083397133"}}
[debug] [2025-08-27T11:28:03.357Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:03.357Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:03.357Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/tax-code-flutter/billingInfo [none]
[debug] [2025-08-27T11:28:04.082Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/tax-code-flutter/billingInfo 200
[debug] [2025-08-27T11:28:04.082Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/tax-code-flutter/billingInfo {"name":"projects/tax-code-flutter/billingInfo","projectId":"tax-code-flutter","billingAccountName":"billingAccounts/01EA50-FF19E1-0A6478","billingEnabled":true}
[debug] [2025-08-27T11:28:04.083Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:04.083Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:04.083Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions:generateUploadUrl [none]
[debug] [2025-08-27T11:28:04.282Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions:generateUploadUrl 200
[debug] [2025-08-27T11:28:04.282Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/238c3a89-1c68-4df5-8150-24dddd51fe57.zip?GoogleAccessId=service-1006489964692@gcf-admin-robot.iam.gserviceaccount.com&Expires=1756295876&Signature=VGp7reCJOFW8Civ87zxCt1EAXw06P0JnEawrpYHi7b9xipklC6jQk9lGm2jESeUJ0SH7AZ96ZgQWd9Dih7DC7naSEAMDjg0XDtLLVktohjatF1hzGWFMLizoWCAMEPuQ6ywah14fclzAZCoVsfKkYRIdfsGsiHFxJdQTIIWbFKoX6jSTA%2BVYzu0w%2FtdEkbMATPsUgJATN7kp3hh%2B0wIOih6Sg6P1HbDZoM5az3re5bdW0w%2F0E34%2FrmG2%2FyekL54bfE%2B8tPaRarASCXLKiDYZEnaTg5dXCXKHQSEpDbfKtd5Haiibg2sVJCSLkAjsPXqP2QWl%2FFY6sG3RyxQLokc6CA%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com","object":"238c3a89-1c68-4df5-8150-24dddd51fe57.zip"}}
[debug] [2025-08-27T11:28:04.282Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/238c3a89-1c68-4df5-8150-24dddd51fe57.zip GoogleAccessId=service-1006489964692%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1756295876&Signature=VGp7reCJOFW8Civ87zxCt1EAXw06P0JnEawrpYHi7b9xipklC6jQk9lGm2jESeUJ0SH7AZ96ZgQWd9Dih7DC7naSEAMDjg0XDtLLVktohjatF1hzGWFMLizoWCAMEPuQ6ywah14fclzAZCoVsfKkYRIdfsGsiHFxJdQTIIWbFKoX6jSTA%2BVYzu0w%2FtdEkbMATPsUgJATN7kp3hh%2B0wIOih6Sg6P1HbDZoM5az3re5bdW0w%2F0E34%2FrmG2%2FyekL54bfE%2B8tPaRarASCXLKiDYZEnaTg5dXCXKHQSEpDbfKtd5Haiibg2sVJCSLkAjsPXqP2QWl%2FFY6sG3RyxQLokc6CA%3D%3D
[debug] [2025-08-27T11:28:04.282Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/238c3a89-1c68-4df5-8150-24dddd51fe57.zip [stream]
[debug] [2025-08-27T11:28:04.631Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/238c3a89-1c68-4df5-8150-24dddd51fe57.zip 200
[debug] [2025-08-27T11:28:04.632Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/238c3a89-1c68-4df5-8150-24dddd51fe57.zip [omitted]
[info] +  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 22 (2nd Gen) function extractDataFromDocument(europe-west1)... 
[debug] [2025-08-27T11:28:04.634Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:04.634Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:04.634Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions functionId=extractDataFromDocument
[debug] [2025-08-27T11:28:04.634Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions {"name":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","buildConfig":{"runtime":"nodejs22","entryPoint":"extractDataFromDocument","source":{"storageSource":{"bucket":"gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com","object":"238c3a89-1c68-4df5-8150-24dddd51fe57.zip"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}},"serviceConfig":{"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}","GCLOUD_PROJECT":"tax-code-flutter","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument","FUNCTION_TARGET":"extractDataFromDocument","LOG_EXECUTION_ID":"true"},"ingressSettings":null,"timeoutSeconds":null,"serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","availableMemory":"256Mi","minInstanceCount":null,"maxInstanceCount":null,"maxInstanceRequestConcurrency":80,"availableCpu":"1","vpcConnector":null,"vpcConnectorEgressSettings":null},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6711fee3b7b0348cc9f7e47841afe6edf6dc7078"}}
[debug] [2025-08-27T11:28:05.567Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions 200
[debug] [2025-08-27T11:28:05.567Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T11:27:57.847756905Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-08-27T11:28:05.567Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:05.567Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:05.568Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea [none]
[debug] [2025-08-27T11:28:05.690Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea 200
[debug] [2025-08-27T11:28:05.690Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T11:27:57.847756905Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-08-27T11:28:06.194Z] [create-default-europe-west1-extractDataFromDocument] Retrying task index 0
[debug] [2025-08-27T11:28:06.194Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:06.194Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:06.194Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea [none]
[debug] [2025-08-27T11:28:06.297Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea 200
[debug] [2025-08-27T11:28:06.298Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T11:27:57.847756905Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","buildConfig":{"runtime":"nodejs22","entryPoint":"extractDataFromDocument","source":{"storageSource":{"bucket":"gcf-v2-sources-1006489964692-europe-west1","object":"extractDataFromDocument/function-source.zip","generation":"1756294077328676"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"serviceAccount":"projects/tax-code-flutter/serviceAccounts/1006489964692-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/tax-code-flutter/locations/europe-west1/services/extractdatafromdocument","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}","GCLOUD_PROJECT":"tax-code-flutter","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument","FUNCTION_TARGET":"extractDataFromDocument","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6711fee3b7b0348cc9f7e47841afe6edf6dc7078"},"environment":"GEN_2"},"stages":[{"name":"ARTIFACT_REGISTRY","state":"NOT_STARTED"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"CREATE_FUNCTION"},"done":false}
[debug] [2025-08-27T11:28:07.303Z] [create-default-europe-west1-extractDataFromDocument] Retrying task index 0
[debug] [2025-08-27T11:28:07.303Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:07.303Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:07.303Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea [none]
[debug] [2025-08-27T11:28:07.423Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea 200
[debug] [2025-08-27T11:28:07.424Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756294077052-63d57149577c2-027b37e7-983f34ea","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T11:27:57.847756905Z","endTime":"2025-08-27T11:27:58.978972161Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","buildConfig":{"runtime":"nodejs22","entryPoint":"extractDataFromDocument","source":{"storageSource":{"bucket":"gcf-v2-sources-1006489964692-europe-west1","object":"extractDataFromDocument/function-source.zip","generation":"1756294077328676"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"serviceAccount":"projects/tax-code-flutter/serviceAccounts/1006489964692-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/tax-code-flutter/locations/europe-west1/services/extractdatafromdocument","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}","GCLOUD_PROJECT":"tax-code-flutter","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument","FUNCTION_TARGET":"extractDataFromDocument","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6711fee3b7b0348cc9f7e47841afe6edf6dc7078"},"environment":"GEN_2"},"stages":[{"name":"ARTIFACT_REGISTRY","message":"Deleting function artifacts in Artifact Registry","state":"COMPLETE"},{"name":"SERVICE","message":"Deleting Cloud Run service","state":"COMPLETE","resource":"projects/tax-code-flutter/locations/europe-west1/services/extractdatafromdocument"}],"operationType":"CREATE_FUNCTION"},"done":true,"error":{"code":7,"message":"Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes."}}
[debug] [2025-08-27T11:28:07.424Z] Got source token undefined for region europe-west1
[error] Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes.
[debug] [2025-08-27T11:28:07.427Z] Total Function Deployment time: 2791
[debug] [2025-08-27T11:28:07.427Z] 1 Functions Deployed
[debug] [2025-08-27T11:28:07.427Z] 1 Functions Errored
[debug] [2025-08-27T11:28:07.427Z] 0 Function Deployments Aborted
[debug] [2025-08-27T11:28:07.427Z] Average Function Deployment time: 2791
[info] 
[info] Functions deploy had errors with the following functions:
	extractDataFromDocument(europe-west1)
[debug] [2025-08-27T11:28:07.579Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:07.579Z] Checked if tokens are valid: true, expires at: 1756297382494
[debug] [2025-08-27T11:28:07.579Z] >>> [apiv2][query] GET https://artifactregistry.googleapis.com/v1/projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts [none]
[debug] [2025-08-27T11:28:07.801Z] <<< [apiv2][status] GET https://artifactregistry.googleapis.com/v1/projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts 200
[debug] [2025-08-27T11:28:07.801Z] <<< [apiv2][body] GET https://artifactregistry.googleapis.com/v1/projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts {"name":"projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts","format":"DOCKER","description":"This repository is created and used by Cloud Functions for storing function docker images.","labels":{"goog-managed-by":"cloudfunctions"},"createTime":"2025-08-26T23:33:29.573438Z","updateTime":"2025-08-26T23:33:43.097174Z","mode":"STANDARD_REPOSITORY","cleanupPolicies":{"firebase-functions-cleanup":{"id":"firebase-functions-cleanup","action":"DELETE","condition":{"tagState":"ANY","olderThan":"86400s"}}},"vulnerabilityScanningConfig":{"lastEnableTime":"2025-08-26T23:33:20.012234893Z","enablementState":"SCANNING_DISABLED","enablementStateReason":"API containerscanning.googleapis.com is not enabled."},"satisfiesPzi":true,"registryUri":"europe-west1-docker.pkg.dev/tax-code-flutter/gcf-artifacts"}
[debug] [2025-08-27T11:28:07.801Z] Functions deploy failed.
[debug] [2025-08-27T11:28:07.801Z] {
  "endpoint": {
    "id": "extractDataFromDocument",
    "project": "tax-code-flutter",
    "region": "europe-west1",
    "entryPoint": "extractDataFromDocument",
    "platform": "gcfv2",
    "runtime": "nodejs22",
    "callableTrigger": {},
    "labels": {
      "deployment-tool": "cli-firebase"
    },
    "serviceAccount": "vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com",
    "ingressSettings": null,
    "availableMemoryMb": null,
    "timeoutSeconds": null,
    "maxInstances": null,
    "minInstances": null,
    "concurrency": 80,
    "vpc": null,
    "environmentVariables": {
      "FIREBASE_CONFIG": "{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}",
      "GCLOUD_PROJECT": "tax-code-flutter",
      "EVENTARC_CLOUD_EVENT_SOURCE": "projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument"
    },
    "codebase": "default",
    "cpu": 1,
    "targetedByOnly": false,
    "hash": "6711fee3b7b0348cc9f7e47841afe6edf6dc7078"
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "exit": 1,
    "message": "Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes.",
    "original": {
      "code": 7,
      "message": "Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes."
    },
    "status": 7,
    "code": 7
  }
}
[debug] [2025-08-27T11:28:07.843Z] Error: Failed to create function extractDataFromDocument in region europe-west1
    at C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:306:27
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Fabricator.createV2Function (C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:290:30)
    at async Fabricator.createEndpoint (C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:137:13)
    at async handle (C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:89:17)
[error] 
[error] Error: There was an error deploying functions
[debug] [2025-08-27T16:29:06.734Z] ----------------------------------------------------------------------
[debug] [2025-08-27T16:29:06.735Z] Command:       C:\nvm4w\nodejs\node.exe C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\bin\firebase.js deploy --only functions
[debug] [2025-08-27T16:29:06.735Z] CLI Version:   14.14.0
[debug] [2025-08-27T16:29:06.735Z] Platform:      win32
[debug] [2025-08-27T16:29:06.736Z] Node Version:  v22.18.0
[debug] [2025-08-27T16:29:06.736Z] Time:          Wed Aug 27 2025 18:29:06 GMT+0200 (Ora legale dellâ€™Europa centrale)
[debug] [2025-08-27T16:29:06.736Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-08-27T16:29:06.844Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-08-27T16:29:06.844Z] > authorizing via signed-in user (tommaso.scalici.1991@gmail.com)
[debug] [2025-08-27T16:29:06.844Z] [iam] checking project tax-code-flutter for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-08-27T16:29:06.845Z] Checked if tokens are valid: false, expires at: 1756297382494
[debug] [2025-08-27T16:29:06.845Z] Checked if tokens are valid: false, expires at: 1756297382494
[debug] [2025-08-27T16:29:06.845Z] > refreshing access token with scopes: []
[debug] [2025-08-27T16:29:06.846Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-08-27T16:29:06.846Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-08-27T16:29:07.041Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-08-27T16:29:07.041Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-08-27T16:29:07.067Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions [none]
[debug] [2025-08-27T16:29:07.067Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions x-goog-quota-user=projects/tax-code-flutter
[debug] [2025-08-27T16:29:07.067Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-08-27T16:29:07.910Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions 200
[debug] [2025-08-27T16:29:07.910Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-08-27T16:29:07.910Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:07.910Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:07.910Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-08-27T16:29:07.910Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-08-27T16:29:08.793Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-08-27T16:29:08.793Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/tax-code-flutter/serviceAccounts/tax-code-flutter@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'tax-code-flutter'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] Running command: npm --prefix "$RESOURCE_DIR" run build
[info] +  functions: Finished running predeploy script. 
[debug] [2025-08-27T16:29:35.339Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:35.339Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:35.339Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter [none]
[debug] [2025-08-27T16:29:36.166Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter 200
[debug] [2025-08-27T16:29:36.167Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter {"projectNumber":"1006489964692","projectId":"tax-code-flutter","lifecycleState":"ACTIVE","name":"Tax Code","labels":{"firebase":"enabled","generative-language":"enabled"},"createTime":"2024-07-01T12:17:58.718194Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-08-27T16:29:36.171Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:36.171Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:36.171Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/tax-code-flutter/adminSdkConfig [none]
[debug] [2025-08-27T16:29:36.519Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/tax-code-flutter/adminSdkConfig 200
[debug] [2025-08-27T16:29:36.520Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/tax-code-flutter/adminSdkConfig {"projectId":"tax-code-flutter","storageBucket":"tax-code-flutter.firebasestorage.app"}
[debug] [2025-08-27T16:29:36.520Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:36.521Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:36.521Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs [none]
[debug] [2025-08-27T16:29:36.888Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs 200
[debug] [2025-08-27T16:29:36.888Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs {"configs":[{"name":"projects/tax-code-flutter/configs/google"}]}
[debug] [2025-08-27T16:29:36.888Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:36.888Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:36.889Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables [none]
[debug] [2025-08-27T16:29:37.114Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables 200
[debug] [2025-08-27T16:29:37.114Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables {"variables":[{"name":"projects/tax-code-flutter/configs/google/variables/vision/key","updateTime":"2024-10-12T18:32:43.792485565Z"}]}
[debug] [2025-08-27T16:29:37.115Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:37.115Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:37.115Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables/vision/key [none]
[debug] [2025-08-27T16:29:37.334Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables/vision/key 200
[debug] [2025-08-27T16:29:37.334Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/tax-code-flutter/configs/google/variables/vision/key {"name":"projects/tax-code-flutter/configs/google/variables/vision/key","updateTime":"2024-10-12T18:32:43.792485565Z","text":"$(cat functions/tax-code-flutter-5fd627c30f2b.json)"}
[debug] [2025-08-27T16:29:37.337Z] Validating nodejs source
[debug] [2025-08-27T16:29:38.083Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "lint": "eslint --ext .js,.ts .",
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "22"
  },
  "main": "lib/index.js",
  "dependencies": {
    "@google-cloud/vertexai": "^1.10.0",
    "firebase-admin": "^12.6.0",
    "firebase-functions": "^6.0.1"
  },
  "devDependencies": {
    "@typescript-eslint/eslint-plugin": "^5.12.0",
    "@typescript-eslint/parser": "^5.12.0",
    "eslint": "^8.9.0",
    "eslint-config-google": "^0.14.0",
    "eslint-config-prettier": "^10.1.8",
    "eslint-plugin-import": "^2.25.4",
    "eslint-plugin-prettier": "^5.5.4",
    "firebase-functions-test": "^3.1.0",
    "typescript": "^5.7.3"
  },
  "private": true
}
[debug] [2025-08-27T16:29:38.083Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-08-27T16:29:38.084Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-08-27T16:29:38.091Z] Found firebase-functions binary at 'C:\Users\Tommaso\source\repos\tax_code_flutter\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8160

[debug] [2025-08-27T16:29:46.950Z] Got response from /__/functions.yaml {"endpoints":{"extractDataFromDocument":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","vpc":null,"platform":"gcfv2","region":["europe-west1"],"labels":{},"callableTrigger":{},"entryPoint":"extractDataFromDocument"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2025-08-27T16:29:50.986Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-08-27T16:29:50.986Z] > authorizing via signed-in user (tommaso.scalici.1991@gmail.com)
[debug] [2025-08-27T16:29:50.987Z] [iam] checking project tax-code-flutter for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2025-08-27T16:29:50.987Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:50.987Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:50.987Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions [none]
[debug] [2025-08-27T16:29:50.987Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions x-goog-quota-user=projects/tax-code-flutter
[debug] [2025-08-27T16:29:50.987Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-08-27T16:29:51.792Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions 200
[debug] [2025-08-27T16:29:51.793Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/tax-code-flutter:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-08-27T16:29:51.795Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:51.795Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:51.798Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/tax-code-flutter/instances pageSize=100&pageToken=
[debug] [2025-08-27T16:29:52.781Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/tax-code-flutter/instances 200
[debug] [2025-08-27T16:29:52.781Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/tax-code-flutter/instances {}
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged C:\Users\Tommaso\source\repos\tax_code_flutter\functions (95.9 KB) for uploading 
[debug] [2025-08-27T16:29:52.821Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:52.821Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:52.821Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/tax-code-flutter/locations/-/functions [none]
[debug] [2025-08-27T16:29:53.551Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/tax-code-flutter/locations/-/functions 200
[debug] [2025-08-27T16:29:53.551Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/tax-code-flutter/locations/-/functions {}
[debug] [2025-08-27T16:29:53.552Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:53.552Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:53.552Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-08-27T16:29:54.580Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/-/functions 200
[debug] [2025-08-27T16:29:54.580Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/-/functions {}
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[debug] [2025-08-27T16:29:54.589Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:54.589Z] Checked if tokens are valid: true, expires at: 1756315746041
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-08-27T16:29:54.589Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:54.589Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:54.589Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-08-27T16:29:54.590Z] >>> [apiv2][(partial)header] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity x-goog-quota-user=projects/1006489964692
[debug] [2025-08-27T16:29:54.590Z] >>> [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity {}
[debug] [2025-08-27T16:29:54.591Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-08-27T16:29:54.591Z] >>> [apiv2][(partial)header] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity x-goog-quota-user=projects/1006489964692
[debug] [2025-08-27T16:29:54.591Z] >>> [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity {}
[debug] [2025-08-27T16:29:55.648Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-08-27T16:29:55.649Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1006489964692@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"111937492104083397133"}}
[debug] [2025-08-27T16:29:55.652Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-08-27T16:29:55.652Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1006489964692/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1006489964692@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"104764459741738401703"}}
[debug] [2025-08-27T16:29:55.657Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:55.657Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:55.657Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/tax-code-flutter/billingInfo [none]
[debug] [2025-08-27T16:29:56.511Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/tax-code-flutter/billingInfo 200
[debug] [2025-08-27T16:29:56.512Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/tax-code-flutter/billingInfo {"name":"projects/tax-code-flutter/billingInfo","projectId":"tax-code-flutter","billingAccountName":"billingAccounts/01EA50-FF19E1-0A6478","billingEnabled":true}
[debug] [2025-08-27T16:29:56.515Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:56.515Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:56.515Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions:generateUploadUrl [none]
[debug] [2025-08-27T16:29:56.729Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions:generateUploadUrl 200
[debug] [2025-08-27T16:29:56.729Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip?GoogleAccessId=service-1006489964692@gcf-admin-robot.iam.gserviceaccount.com&Expires=1756313988&Signature=VS%2FzqFnS0fJdyEtEyIbFtPBz1eck7iHa8h%2B5uDVESHbnRMMe8t25OErZSr8CUp5BXiCVNx0TSw3l88%2BKWHkUTE5P35pt1F9nz%2FvRO%2FyZo2e1K7LU2hD7AL1Jjurz82I1ZrLpM8oMVF1Fim1uSLlsiKIIrYFmO3FXHnbF%2F0lZM%2BCp877ql%2Fal8%2F%2BrMQO3jx9h2wMLtKrMdsVbaOKcP2VUXQUTDIESc14%2BERE%2Bmy4ecsKA%2FaYf5COmETBTJ7AQmqQpU%2BQt%2FYA3UqtXFCChsaqUkqnhIcsZKlXn0h7sHXjLXshqbmgCp7Lb6RC9PkZ%2FXrhKrszqAiqH1cQ8v71bEITopw%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com","object":"7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip"}}
[debug] [2025-08-27T16:29:56.731Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip GoogleAccessId=service-1006489964692%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1756313988&Signature=VS%2FzqFnS0fJdyEtEyIbFtPBz1eck7iHa8h%2B5uDVESHbnRMMe8t25OErZSr8CUp5BXiCVNx0TSw3l88%2BKWHkUTE5P35pt1F9nz%2FvRO%2FyZo2e1K7LU2hD7AL1Jjurz82I1ZrLpM8oMVF1Fim1uSLlsiKIIrYFmO3FXHnbF%2F0lZM%2BCp877ql%2Fal8%2F%2BrMQO3jx9h2wMLtKrMdsVbaOKcP2VUXQUTDIESc14%2BERE%2Bmy4ecsKA%2FaYf5COmETBTJ7AQmqQpU%2BQt%2FYA3UqtXFCChsaqUkqnhIcsZKlXn0h7sHXjLXshqbmgCp7Lb6RC9PkZ%2FXrhKrszqAiqH1cQ8v71bEITopw%3D%3D
[debug] [2025-08-27T16:29:56.732Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip [stream]
[debug] [2025-08-27T16:29:57.071Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip 200
[debug] [2025-08-27T16:29:57.072Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com/7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip [omitted]
[info] +  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 22 (2nd Gen) function extractDataFromDocument(europe-west1)... 
[debug] [2025-08-27T16:29:57.079Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:57.079Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:57.079Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions functionId=extractDataFromDocument
[debug] [2025-08-27T16:29:57.079Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions {"name":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","buildConfig":{"runtime":"nodejs22","entryPoint":"extractDataFromDocument","source":{"storageSource":{"bucket":"gcf-v2-uploads-1006489964692.europe-west1.cloudfunctions.appspot.com","object":"7df1d7b4-37cf-4d93-8296-fcc640cfca7d.zip"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}},"serviceConfig":{"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}","GCLOUD_PROJECT":"tax-code-flutter","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument","FUNCTION_TARGET":"extractDataFromDocument","LOG_EXECUTION_ID":"true"},"ingressSettings":null,"timeoutSeconds":null,"serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","availableMemory":"256Mi","minInstanceCount":null,"maxInstanceCount":null,"maxInstanceRequestConcurrency":80,"availableCpu":"1","vpcConnector":null,"vpcConnectorEgressSettings":null},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6711fee3b7b0348cc9f7e47841afe6edf6dc7078"}}
[debug] [2025-08-27T16:29:57.898Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions 200
[debug] [2025-08-27T16:29:57.898Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/functions {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T16:29:49.332764347Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-08-27T16:29:57.899Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:57.899Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:57.900Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f [none]
[debug] [2025-08-27T16:29:58.044Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f 200
[debug] [2025-08-27T16:29:58.045Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T16:29:49.332764347Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-08-27T16:29:58.548Z] [create-default-europe-west1-extractDataFromDocument] Retrying task index 0
[debug] [2025-08-27T16:29:58.548Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:58.548Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:58.548Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f [none]
[debug] [2025-08-27T16:29:58.682Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f 200
[debug] [2025-08-27T16:29:58.682Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T16:29:49.332764347Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","buildConfig":{"runtime":"nodejs22","entryPoint":"extractDataFromDocument","source":{"storageSource":{"bucket":"gcf-v2-sources-1006489964692-europe-west1","object":"extractDataFromDocument/function-source.zip","generation":"1756312188935211"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"serviceAccount":"projects/tax-code-flutter/serviceAccounts/1006489964692-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/tax-code-flutter/locations/europe-west1/services/extractdatafromdocument","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}","GCLOUD_PROJECT":"tax-code-flutter","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument","FUNCTION_TARGET":"extractDataFromDocument","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6711fee3b7b0348cc9f7e47841afe6edf6dc7078"},"environment":"GEN_2"},"stages":[{"name":"ARTIFACT_REGISTRY","state":"NOT_STARTED"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"CREATE_FUNCTION"},"done":false}
[debug] [2025-08-27T16:29:59.685Z] [create-default-europe-west1-extractDataFromDocument] Retrying task index 0
[debug] [2025-08-27T16:29:59.685Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:59.685Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:59.685Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f [none]
[debug] [2025-08-27T16:29:59.799Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f 200
[debug] [2025-08-27T16:29:59.799Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f {"name":"projects/tax-code-flutter/locations/europe-west1/operations/operation-1756312188669-63d5b4c1ed02d-73550aca-3f37ea8f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-08-27T16:29:49.332764347Z","endTime":"2025-08-27T16:29:50.511398380Z","target":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","verb":"create","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/tax-code-flutter/locations/europe-west1/functions/extractDataFromDocument","buildConfig":{"runtime":"nodejs22","entryPoint":"extractDataFromDocument","source":{"storageSource":{"bucket":"gcf-v2-sources-1006489964692-europe-west1","object":"extractDataFromDocument/function-source.zip","generation":"1756312188935211"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"serviceAccount":"projects/tax-code-flutter/serviceAccounts/1006489964692-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/tax-code-flutter/locations/europe-west1/services/extractdatafromdocument","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}","GCLOUD_PROJECT":"tax-code-flutter","EVENTARC_CLOUD_EVENT_SOURCE":"projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument","FUNCTION_TARGET":"extractDataFromDocument","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com","availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"6711fee3b7b0348cc9f7e47841afe6edf6dc7078"},"environment":"GEN_2"},"stages":[{"name":"ARTIFACT_REGISTRY","message":"Deleting function artifacts in Artifact Registry","state":"COMPLETE"},{"name":"SERVICE","message":"Deleting Cloud Run service","state":"COMPLETE","resource":"projects/tax-code-flutter/locations/europe-west1/services/extractdatafromdocument"}],"operationType":"CREATE_FUNCTION"},"done":true,"error":{"code":7,"message":"Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes."}}
[debug] [2025-08-27T16:29:59.799Z] Got source token undefined for region europe-west1
[error] Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes.
[debug] [2025-08-27T16:29:59.811Z] Total Function Deployment time: 2726
[debug] [2025-08-27T16:29:59.811Z] 1 Functions Deployed
[debug] [2025-08-27T16:29:59.811Z] 1 Functions Errored
[debug] [2025-08-27T16:29:59.811Z] 0 Function Deployments Aborted
[debug] [2025-08-27T16:29:59.811Z] Average Function Deployment time: 2725
[info] 
[info] Functions deploy had errors with the following functions:
	extractDataFromDocument(europe-west1)
[debug] [2025-08-27T16:29:59.946Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:59.947Z] Checked if tokens are valid: true, expires at: 1756315746041
[debug] [2025-08-27T16:29:59.947Z] >>> [apiv2][query] GET https://artifactregistry.googleapis.com/v1/projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts [none]
[debug] [2025-08-27T16:30:00.230Z] <<< [apiv2][status] GET https://artifactregistry.googleapis.com/v1/projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts 200
[debug] [2025-08-27T16:30:00.231Z] <<< [apiv2][body] GET https://artifactregistry.googleapis.com/v1/projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts {"name":"projects/tax-code-flutter/locations/europe-west1/repositories/gcf-artifacts","format":"DOCKER","description":"This repository is created and used by Cloud Functions for storing function docker images.","labels":{"goog-managed-by":"cloudfunctions"},"createTime":"2025-08-26T23:33:29.573438Z","updateTime":"2025-08-26T23:33:43.097174Z","mode":"STANDARD_REPOSITORY","cleanupPolicies":{"firebase-functions-cleanup":{"id":"firebase-functions-cleanup","action":"DELETE","condition":{"tagState":"ANY","olderThan":"86400s"}}},"vulnerabilityScanningConfig":{"lastEnableTime":"2025-08-26T23:33:20.012234893Z","enablementState":"SCANNING_DISABLED","enablementStateReason":"API containerscanning.googleapis.com is not enabled."},"satisfiesPzi":true,"registryUri":"europe-west1-docker.pkg.dev/tax-code-flutter/gcf-artifacts"}
[debug] [2025-08-27T16:30:00.231Z] Functions deploy failed.
[debug] [2025-08-27T16:30:00.231Z] {
  "endpoint": {
    "id": "extractDataFromDocument",
    "project": "tax-code-flutter",
    "region": "europe-west1",
    "entryPoint": "extractDataFromDocument",
    "platform": "gcfv2",
    "runtime": "nodejs22",
    "callableTrigger": {},
    "labels": {
      "deployment-tool": "cli-firebase"
    },
    "serviceAccount": "vertex-ai-invoker@tax-code-flutter.iam.gserviceaccount.com",
    "ingressSettings": null,
    "availableMemoryMb": null,
    "timeoutSeconds": null,
    "maxInstances": null,
    "minInstances": null,
    "concurrency": 80,
    "vpc": null,
    "environmentVariables": {
      "FIREBASE_CONFIG": "{\"projectId\":\"tax-code-flutter\",\"storageBucket\":\"tax-code-flutter.firebasestorage.app\"}",
      "GCLOUD_PROJECT": "tax-code-flutter",
      "EVENTARC_CLOUD_EVENT_SOURCE": "projects/tax-code-flutter/locations/europe-west1/services/extractDataFromDocument"
    },
    "codebase": "default",
    "cpu": 1,
    "targetedByOnly": false,
    "hash": "6711fee3b7b0348cc9f7e47841afe6edf6dc7078"
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "exit": 1,
    "message": "Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes.",
    "original": {
      "code": 7,
      "message": "Could not build the function due to missing permissions. generic::permission_denied: Caller does not have required permission to use project tax-code-flutter. Grant the caller the roles/serviceusage.serviceUsageConsumer role, or a custom role with the serviceusage.services.use permission, by visiting https://console.developers.google.com/iam-admin/iam/project?project=tax-code-flutter and then retry. Propagation of the new permission may take a few minutes."
    },
    "status": 7,
    "code": 7
  }
}
[debug] [2025-08-27T16:30:00.281Z] Error: Failed to create function extractDataFromDocument in region europe-west1
    at C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:306:27
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Fabricator.createV2Function (C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:290:30)
    at async Fabricator.createEndpoint (C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:137:13)
    at async handle (C:\Users\Tommaso\AppData\Local\pnpm\global\5\.pnpm\firebase-tools@14.14.0_@types+node@24.3.0_encoding@0.1.13\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:89:17)
[error] 
[error] Error: There was an error deploying functions
